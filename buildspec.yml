version: 0.2

env:
  variables:
    SITE_BUCKET: "ls-cloud-migration-hub-williamoconnellpmp"
    CF_DISTRIBUTION_ID: "E3GKP8EZSZFBWI"

phases:
  install:
    runtime-versions:
      nodejs: 20
    commands:
      - npm ci

  build:
    commands:
      - npm run build

  post_build:
    commands:
      - aws s3 sync ./out s3://$SITE_BUCKET --delete
      - aws cloudfront create-invalidation --distribution-id $CF_DISTRIBUTION_ID --paths "/*"
